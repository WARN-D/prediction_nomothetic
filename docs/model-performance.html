<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Model Performance | Integrating ecological momentary and passive sensing data to improve depression severity prediction: insights from the WARN-D study</title>
  <meta name="description" content="9 Model Performance | Integrating ecological momentary and passive sensing data to improve depression severity prediction: insights from the WARN-D study" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Model Performance | Integrating ecological momentary and passive sensing data to improve depression severity prediction: insights from the WARN-D study" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Model Performance | Integrating ecological momentary and passive sensing data to improve depression severity prediction: insights from the WARN-D study" />
  
  
  

<meta name="author" content="Rayyan Tutunji" />


<meta name="date" content="2025-11-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="results.html"/>
<link rel="next" href="idiographic-model-performance.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>2</b> Data Prep</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-prep.html"><a href="data-prep.html#processing"><i class="fa fa-check"></i><b>2.1</b> Processing</a></li>
<li class="chapter" data-level="2.2" data-path="data-prep.html"><a href="data-prep.html#compliance-estimates"><i class="fa fa-check"></i><b>2.2</b> Compliance Estimates</a></li>
<li class="chapter" data-level="2.3" data-path="data-prep.html"><a href="data-prep.html#data-merger"><i class="fa fa-check"></i><b>2.3</b> Data Merger</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>3</b> Descriptives</a>
<ul>
<li class="chapter" data-level="" data-path="descriptives.html"><a href="descriptives.html#demographics"><i class="fa fa-check"></i>Demographics</a></li>
<li class="chapter" data-level="" data-path="descriptives.html"><a href="descriptives.html#compliance-rates"><i class="fa fa-check"></i>Compliance Rates</a></li>
<li class="chapter" data-level="" data-path="descriptives.html"><a href="descriptives.html#feature-correlations"><i class="fa fa-check"></i>Feature Correlations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="imputation.html"><a href="imputation.html"><i class="fa fa-check"></i><b>4</b> Imputation</a></li>
<li class="chapter" data-level="5" data-path="dataset-creation.html"><a href="dataset-creation.html"><i class="fa fa-check"></i><b>5</b> Dataset Creation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dataset-creation.html"><a href="dataset-creation.html#weekly-data"><i class="fa fa-check"></i><b>5.1</b> Weekly Data</a></li>
<li class="chapter" data-level="5.2" data-path="dataset-creation.html"><a href="dataset-creation.html#daily-data"><i class="fa fa-check"></i><b>5.2</b> Daily Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dataset-export.html"><a href="dataset-export.html"><i class="fa fa-check"></i><b>6</b> Dataset Export</a></li>
<li class="chapter" data-level="7" data-path="model-testing.html"><a href="model-testing.html"><i class="fa fa-check"></i><b>7</b> Model Testing</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model-testing.html"><a href="model-testing.html#model-predictions"><i class="fa fa-check"></i><b>7.1</b> Model Predictions</a></li>
<li class="chapter" data-level="7.2" data-path="model-testing.html"><a href="model-testing.html#shap-estimate"><i class="fa fa-check"></i><b>7.2</b> SHAP Estimate</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>8</b> Results</a></li>
<li class="chapter" data-level="9" data-path="model-performance.html"><a href="model-performance.html"><i class="fa fa-check"></i><b>9</b> Model Performance</a>
<ul>
<li class="chapter" data-level="" data-path="model-performance.html"><a href="model-performance.html#training-cv"><i class="fa fa-check"></i>Training CV</a></li>
<li class="chapter" data-level="" data-path="model-performance.html"><a href="model-performance.html#test-data"><i class="fa fa-check"></i>Test Data</a></li>
<li class="chapter" data-level="9.1" data-path="model-performance.html"><a href="model-performance.html#full-results"><i class="fa fa-check"></i><b>9.1</b> Full Results</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="idiographic-model-performance.html"><a href="idiographic-model-performance.html"><i class="fa fa-check"></i><b>10</b> Idiographic Model Performance</a></li>
<li class="chapter" data-level="11" data-path="shap.html"><a href="shap.html"><i class="fa fa-check"></i><b>11</b> SHAP</a>
<ul>
<li class="chapter" data-level="" data-path="shap.html"><a href="shap.html#top-10-daily"><i class="fa fa-check"></i>Top 10 Daily</a></li>
<li class="chapter" data-level="11.1" data-path="shap.html"><a href="shap.html#top-10-weekly"><i class="fa fa-check"></i><b>11.1</b> Top 10 Weekly</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="supp-analysis.html"><a href="supp-analysis.html"><i class="fa fa-check"></i><b>12</b> Supp Analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="supp-analysis.html"><a href="supp-analysis.html#phq-9-autoregressive-model"><i class="fa fa-check"></i><b>12.1</b> PHQ-9 Autoregressive Model</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Integrating ecological momentary and passive sensing data to improve depression severity prediction: insights from the WARN-D study</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-performance" class="section level1 tabset hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Model Performance<a href="model-performance.html#model-performance" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>First check the model performance. I do this by loading the model results as csvs which contain the predictions and actual scores for each of the training and test set, then estimating the mean error (ME), mean absolute error (MAE), mean absolute percent error (MAPE), root mean square error (RMSE), and R^2. R^2 is our primary metric of interest here as its the easiest to interpret for psychologists (our target audience).</p>
<div id="training-cv" class="section level2 unnumbered hasAnchor">
<h2>Training CV<a href="model-performance.html#training-cv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="model-performance.html#cb37-1" tabindex="-1"></a><span class="co"># Load the results from the training CV</span></span>
<span id="cb37-2"><a href="model-performance.html#cb37-2" tabindex="-1"></a>training_cv <span class="ot">=</span> <span class="fu">Sys.glob</span>(<span class="st">&quot;C:/Users/rayya/Nextcloud/FSW_WARN-D (Projectfolder)/group/raytut/projects/prediction_nomothetic/results/results_training*.csv&quot;</span>)</span>
<span id="cb37-3"><a href="model-performance.html#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="model-performance.html#cb37-4" tabindex="-1"></a><span class="co"># Read all results into a df</span></span>
<span id="cb37-5"><a href="model-performance.html#cb37-5" tabindex="-1"></a>df_val <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">lapply</span>(training_cv, fread))</span>
<span id="cb37-6"><a href="model-performance.html#cb37-6" tabindex="-1"></a>df_val <span class="ot">&lt;-</span> df_val <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="model-performance.html#cb37-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">factor</span>(source, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;ema&#39;</span>,<span class="st">&#39;epa&#39;</span>, <span class="st">&#39;all&#39;</span>, <span class="st">&quot;phq_lag1&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="model-performance.html#cb37-8" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id, fold, model, source) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="model-performance.html#cb37-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n  =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(actual))</span>
<span id="cb37-10"><a href="model-performance.html#cb37-10" tabindex="-1"></a></span>
<span id="cb37-11"><a href="model-performance.html#cb37-11" tabindex="-1"></a>df_val <span class="sc">%&gt;%</span> </span>
<span id="cb37-12"><a href="model-performance.html#cb37-12" tabindex="-1"></a>  <span class="fu">group_by</span>(fold, model, source) <span class="sc">%&gt;%</span>  </span>
<span id="cb37-13"><a href="model-performance.html#cb37-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R2 =</span> <span class="fu">R2</span>(predicted, actual)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-14"><a href="model-performance.html#cb37-14" tabindex="-1"></a>  <span class="fu">group_by</span>(model, source) <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="model-performance.html#cb37-15" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">R2_sd =</span> <span class="fu">sd</span>(R2, <span class="at">na.rm=</span>T)) <span class="ot">-&gt;</span> train_r2sd</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;model&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="model-performance.html#cb39-1" tabindex="-1"></a><span class="co"># Create a summary table </span></span>
<span id="cb39-2"><a href="model-performance.html#cb39-2" tabindex="-1"></a>df_val_summ <span class="ot">&lt;-</span> df_val <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="model-performance.html#cb39-3" tabindex="-1"></a>  <span class="fu">group_by</span>(model, source) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="model-performance.html#cb39-4" tabindex="-1"></a>  <span class="fu">arrange</span>(model, source) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="model-performance.html#cb39-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predicted =</span> <span class="fu">round</span>(predicted)) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="model-performance.html#cb39-6" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ME =</span> (<span class="fu">mean</span>(predicted<span class="sc">-</span>actual)),</span>
<span id="cb39-7"><a href="model-performance.html#cb39-7" tabindex="-1"></a>            <span class="at">ME_CI_L =</span> <span class="fu">confidence_interval</span>((predicted<span class="sc">-</span>actual), <span class="fl">0.95</span>)[<span class="dv">1</span>],</span>
<span id="cb39-8"><a href="model-performance.html#cb39-8" tabindex="-1"></a>            <span class="at">ME_CI_U =</span> <span class="fu">confidence_interval</span>((predicted<span class="sc">-</span>actual), <span class="fl">0.95</span>)[<span class="dv">2</span>],</span>
<span id="cb39-9"><a href="model-performance.html#cb39-9" tabindex="-1"></a>            <span class="at">MAE =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted<span class="sc">-</span>actual)),</span>
<span id="cb39-10"><a href="model-performance.html#cb39-10" tabindex="-1"></a>            <span class="at">MAPE =</span> (<span class="fu">mean</span>(<span class="fu">abs</span>(predicted<span class="sc">-</span>actual)<span class="sc">/</span>actual))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb39-11"><a href="model-performance.html#cb39-11" tabindex="-1"></a>            <span class="at">RMSE =</span> <span class="fu">RMSE</span>(predicted, actual),</span>
<span id="cb39-12"><a href="model-performance.html#cb39-12" tabindex="-1"></a>            <span class="at">R2 =</span> <span class="fu">R2</span>(predicted, actual)) <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="model-performance.html#cb39-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>( <span class="fu">c</span>(ME, ME_CI_L, MAE, ME_CI_U, MAPE, RMSE, R2), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;model&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="model-performance.html#cb41-1" tabindex="-1"></a>df_val_summ <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_val_summ, train_r2sd, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;model&quot;</span>, <span class="st">&quot;source&quot;</span>))</span>
<span id="cb41-2"><a href="model-performance.html#cb41-2" tabindex="-1"></a>df_val_summ</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["source"],"name":[2],"type":["fct"],"align":["left"]},{"label":["ME"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ME_CI_L"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ME_CI_U"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MAPE"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["R2_sd"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"day","2":"all","3":"-0.36","4":"-0.37","5":"-0.34","6":"1.63","7":"28.45","8":"2.25","9":"0.38","10":"0.018149171"},{"1":"day","2":"ema","3":"-0.39","4":"-0.41","5":"-0.37","6":"1.61","7":"28.00","8":"2.24","9":"0.38","10":"0.017863151"},{"1":"day","2":"epa","3":"-0.65","4":"-0.67","5":"-0.63","6":"2.17","7":"38.96","8":"2.84","9":"0.01","10":"0.006036777"},{"1":"day","2":"phq_lag1","3":"-0.94","4":"-0.96","5":"-0.92","6":"1.90","7":"30.89","8":"2.65","9":"0.20","10":"0.044770439"},{"1":"week","2":"all","3":"-0.80","4":"-0.89","5":"-0.70","6":"3.22","7":"67.56","8":"4.32","9":"0.21","10":"0.040886633"},{"1":"week","2":"ema","3":"-0.58","4":"-0.67","5":"-0.48","6":"3.21","7":"70.32","8":"4.24","9":"0.22","10":"0.043853329"},{"1":"week","2":"epa","3":"-0.90","4":"-1.00","5":"-0.79","6":"3.66","7":"85.14","8":"4.80","9":"0.01","10":"0.008112978"},{"1":"week","2":"phq_lag1","3":"-0.26","4":"-0.33","5":"-0.19","6":"2.27","7":"46.61","8":"3.12","9":"0.57","10":"0.044150275"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="model-performance.html#cb42-1" tabindex="-1"></a>df_val_summ<span class="sc">$</span>set <span class="ot">=</span> <span class="st">&quot;cv&quot;</span></span></code></pre></div>
</div>
<div id="test-data" class="section level2 unnumbered hasAnchor">
<h2>Test Data<a href="model-performance.html#test-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="model-performance.html#cb43-1" tabindex="-1"></a>test_cv <span class="ot">=</span> <span class="fu">Sys.glob</span>(<span class="st">&quot;C:/Users/rayya/Nextcloud/FSW_WARN-D (Projectfolder)/group/raytut/projects/prediction_nomothetic/results/results_testing_*.csv&quot;</span>)</span>
<span id="cb43-2"><a href="model-performance.html#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="model-performance.html#cb43-3" tabindex="-1"></a><span class="co"># Read all results into a df</span></span>
<span id="cb43-4"><a href="model-performance.html#cb43-4" tabindex="-1"></a>df_test <span class="ot">=</span> <span class="fu">rbindlist</span>(<span class="fu">lapply</span>(test_cv, fread), <span class="at">fill=</span>T)</span>
<span id="cb43-5"><a href="model-performance.html#cb43-5" tabindex="-1"></a>df_test <span class="ot">&lt;-</span> df_test <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="model-performance.html#cb43-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">factor</span>(source, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;ema&#39;</span>,<span class="st">&#39;epa&#39;</span>, <span class="st">&#39;all&#39;</span>, <span class="st">&quot;phq_lag1&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb43-7"><a href="model-performance.html#cb43-7" tabindex="-1"></a>  <span class="fu">group_by</span>(sub_id, fold, model, source) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="model-performance.html#cb43-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n  =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(actual)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-9"><a href="model-performance.html#cb43-9" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb43-10"><a href="model-performance.html#cb43-10" tabindex="-1"></a></span>
<span id="cb43-11"><a href="model-performance.html#cb43-11" tabindex="-1"></a>df_test <span class="sc">%&gt;%</span> </span>
<span id="cb43-12"><a href="model-performance.html#cb43-12" tabindex="-1"></a>  <span class="fu">group_by</span>(fold, model, source) <span class="sc">%&gt;%</span>  </span>
<span id="cb43-13"><a href="model-performance.html#cb43-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R2 =</span> <span class="fu">R2</span>(predicted, actual)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-14"><a href="model-performance.html#cb43-14" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="model-performance.html#cb43-15" tabindex="-1"></a>  <span class="fu">group_by</span>(model, source) <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="model-performance.html#cb43-16" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">R2_sd =</span> <span class="fu">sd</span>(R2, <span class="at">na.rm=</span>T)) <span class="ot">-&gt;</span> testr2_sds</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;model&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="model-performance.html#cb45-1" tabindex="-1"></a><span class="co"># Create a summary table </span></span>
<span id="cb45-2"><a href="model-performance.html#cb45-2" tabindex="-1"></a>df_test_summ <span class="ot">&lt;-</span> df_test <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="model-performance.html#cb45-3" tabindex="-1"></a>  <span class="fu">group_by</span>(model, source) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="model-performance.html#cb45-4" tabindex="-1"></a>  <span class="fu">arrange</span>(model, source) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="model-performance.html#cb45-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predicted =</span> <span class="fu">round</span>(predicted)) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="model-performance.html#cb45-6" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ME =</span> (<span class="fu">mean</span>(predicted<span class="sc">-</span>actual)),</span>
<span id="cb45-7"><a href="model-performance.html#cb45-7" tabindex="-1"></a>            <span class="at">ME_CI_L =</span> <span class="fu">confidence_interval</span>((predicted<span class="sc">-</span>actual), <span class="fl">0.95</span>)[<span class="dv">1</span>],</span>
<span id="cb45-8"><a href="model-performance.html#cb45-8" tabindex="-1"></a>            <span class="at">ME_CI_U =</span> <span class="fu">confidence_interval</span>((predicted<span class="sc">-</span>actual), <span class="fl">0.95</span>)[<span class="dv">2</span>],</span>
<span id="cb45-9"><a href="model-performance.html#cb45-9" tabindex="-1"></a>            <span class="at">MAE =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted<span class="sc">-</span>actual)),</span>
<span id="cb45-10"><a href="model-performance.html#cb45-10" tabindex="-1"></a>            <span class="at">MAPE =</span> (<span class="fu">mean</span>(<span class="fu">abs</span>(predicted<span class="sc">-</span>actual)<span class="sc">/</span>actual))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb45-11"><a href="model-performance.html#cb45-11" tabindex="-1"></a>            <span class="at">RMSE =</span> <span class="fu">RMSE</span>(predicted, actual),</span>
<span id="cb45-12"><a href="model-performance.html#cb45-12" tabindex="-1"></a>            <span class="at">R2 =</span> <span class="fu">R2</span>(predicted, actual)) <span class="sc">%&gt;%</span></span>
<span id="cb45-13"><a href="model-performance.html#cb45-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>( <span class="fu">c</span>(ME, ME_CI_L, MAE, ME_CI_U, MAPE, RMSE, R2), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;model&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="model-performance.html#cb47-1" tabindex="-1"></a><span class="co"># Add the folde R2 SDs and print summary</span></span>
<span id="cb47-2"><a href="model-performance.html#cb47-2" tabindex="-1"></a>df_test_summ <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_test_summ, testr2_sds, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;model&quot;</span>,<span class="st">&quot;source&quot;</span>))</span>
<span id="cb47-3"><a href="model-performance.html#cb47-3" tabindex="-1"></a>df_test_summ</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["source"],"name":[2],"type":["fct"],"align":["left"]},{"label":["ME"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ME_CI_L"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ME_CI_U"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MAPE"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["R2_sd"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"day","2":"all","3":"-0.47","4":"-0.48","5":"-0.46","6":"1.70","7":"28.90","8":"2.35","9":"0.36","10":"0.0020410907"},{"1":"day","2":"ema","3":"-0.51","4":"-0.52","5":"-0.50","6":"1.69","7":"28.53","8":"2.35","9":"0.36","10":"0.0025531264"},{"1":"day","2":"epa","3":"-0.79","4":"-0.80","5":"-0.78","6":"2.27","7":"39.60","8":"2.95","9":"0.00","10":"0.0026947666"},{"1":"week","2":"all","3":"-1.10","4":"-1.15","5":"-1.05","6":"3.31","7":"63.81","8":"4.40","9":"0.18","10":"0.0119801838"},{"1":"week","2":"ema","3":"-0.92","4":"-0.97","5":"-0.88","6":"3.24","7":"64.00","8":"4.28","9":"0.20","10":"0.0111137193"},{"1":"week","2":"epa","3":"-1.28","4":"-1.33","5":"-1.23","6":"3.73","7":"79.52","8":"4.87","9":"0.00","10":"0.0009219665"},{"1":"week","2":"phq_lag1","3":"-0.32","4":"-0.35","5":"-0.28","6":"2.35","7":"44.86","8":"3.19","9":"0.54","10":"0.0011176160"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="model-performance.html#cb48-1" tabindex="-1"></a>df_test_summ<span class="sc">$</span>set <span class="ot">=</span> <span class="st">&quot;test&quot;</span></span></code></pre></div>
</div>
<div id="full-results" class="section level2 active hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Full Results<a href="model-performance.html#full-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="model-performance.html#cb49-1" tabindex="-1"></a>df_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_val_summ, df_test_summ)</span>
<span id="cb49-2"><a href="model-performance.html#cb49-2" tabindex="-1"></a>df_results <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="model-performance.html#cb49-3" tabindex="-1"></a>  <span class="fu">arrange</span>(model, source, set) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="model-performance.html#cb49-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">11</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">10</span>) </span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["source"],"name":[2],"type":["fct"],"align":["left"]},{"label":["set"],"name":[3],"type":["chr"],"align":["left"]},{"label":["ME"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ME_CI_L"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["ME_CI_U"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["MAE"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["MAPE"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["RMSE"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["R2_sd"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"day","2":"ema","3":"cv","4":"-0.39","5":"-0.41","6":"-0.37","7":"1.61","8":"28.00","9":"2.24","10":"0.38","11":"0.0178631509"},{"1":"day","2":"ema","3":"test","4":"-0.51","5":"-0.52","6":"-0.50","7":"1.69","8":"28.53","9":"2.35","10":"0.36","11":"0.0025531264"},{"1":"day","2":"epa","3":"cv","4":"-0.65","5":"-0.67","6":"-0.63","7":"2.17","8":"38.96","9":"2.84","10":"0.01","11":"0.0060367772"},{"1":"day","2":"epa","3":"test","4":"-0.79","5":"-0.80","6":"-0.78","7":"2.27","8":"39.60","9":"2.95","10":"0.00","11":"0.0026947666"},{"1":"day","2":"all","3":"cv","4":"-0.36","5":"-0.37","6":"-0.34","7":"1.63","8":"28.45","9":"2.25","10":"0.38","11":"0.0181491710"},{"1":"day","2":"all","3":"test","4":"-0.47","5":"-0.48","6":"-0.46","7":"1.70","8":"28.90","9":"2.35","10":"0.36","11":"0.0020410907"},{"1":"day","2":"phq_lag1","3":"cv","4":"-0.94","5":"-0.96","6":"-0.92","7":"1.90","8":"30.89","9":"2.65","10":"0.20","11":"0.0447704390"},{"1":"week","2":"ema","3":"cv","4":"-0.58","5":"-0.67","6":"-0.48","7":"3.21","8":"70.32","9":"4.24","10":"0.22","11":"0.0438533295"},{"1":"week","2":"ema","3":"test","4":"-0.92","5":"-0.97","6":"-0.88","7":"3.24","8":"64.00","9":"4.28","10":"0.20","11":"0.0111137193"},{"1":"week","2":"epa","3":"cv","4":"-0.90","5":"-1.00","6":"-0.79","7":"3.66","8":"85.14","9":"4.80","10":"0.01","11":"0.0081129779"},{"1":"week","2":"epa","3":"test","4":"-1.28","5":"-1.33","6":"-1.23","7":"3.73","8":"79.52","9":"4.87","10":"0.00","11":"0.0009219665"},{"1":"week","2":"all","3":"cv","4":"-0.80","5":"-0.89","6":"-0.70","7":"3.22","8":"67.56","9":"4.32","10":"0.21","11":"0.0408866326"},{"1":"week","2":"all","3":"test","4":"-1.10","5":"-1.15","6":"-1.05","7":"3.31","8":"63.81","9":"4.40","10":"0.18","11":"0.0119801838"},{"1":"week","2":"phq_lag1","3":"cv","4":"-0.26","5":"-0.33","6":"-0.19","7":"2.27","8":"46.61","9":"3.12","10":"0.57","11":"0.0441502749"},{"1":"week","2":"phq_lag1","3":"test","4":"-0.32","5":"-0.35","6":"-0.28","7":"2.35","8":"44.86","9":"3.19","10":"0.54","11":"0.0011176160"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="idiographic-model-performance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
